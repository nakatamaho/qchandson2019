#! STO-3G H2 Hartree-Fock Energy Point
# see also: http://pubchemqc.riken.jp/cgi-bin/molecularquery.py?name=hydrogen

molecule h2 {
H            0.0   0.0   0.0
H            0.0   0.0   1.401
unit bohr
symmetry c1
}

set {
  basis STO-3G
}

en, wfn = energy('hf', return_wfn=True)

nbf = wfn.nso() # of basis function
Ca = wfn.Ca()   # AO->MO matrix
_Ca = np.asarray(Ca)

mints = psi4.core.MintsHelper(wfn.basisset())
mo_I = np.asarray(mints.mo_transform(mints.ao_eri(), Ca, Ca, Ca, Ca))
ao_T = np.asarray(mints.ao_kinetic())
ao_V = np.asarray(mints.ao_potential())

ao_Hcore = ao_T + ao_V
mo_Hcore = np.dot(np.dot(_Ca.T, ao_Hcore), _Ca)

print("1 electron integral")
for i in range(nbf):
  for j in range(i,nbf):
     if (math.fabs(mo_Hcore[i,j]) > 1.0e-8):
          print (i+1,j+1, mo_Hcore[i,j])

print("2 electron integral")
for i in range(nbf):
  for j in range(i,nbf):
    for k in range(nbf):
      for l in range(k,nbf):
        if ( (i*nbf+j) >= (k*nbf+j) ):
          if (math.fabs(mo_I[i,j,k,l]) > 1.0e-8):
            print (i+1,j+1,k+1,l+1, mo_I[i,j,k,l])

